<div id="import-container" class="container">

  <div>
    <acme-navbar creation-date="import.creationDate"></acme-navbar>
  </div>

  <h1>File import</h1>

  <div class="row">
    <div class="col-md-3">

      <!-- Error messages -->
      <uib-alert ng-repeat="alert in import.alerts" type="{{alert.type}}" close="import.closeAlert($index)">
        {{alert.msg}}
      </uib-alert>

      <!-- Upload box -->
      <div nv-file-drop="" uploader="import.uploader" ng-click="import.clickUpload();">
        <div nv-file-over="" uploader="import.uploader" over-class="another-file-over-class"
             class="well my-drop-zone text-center">
          <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span><br/>
          <input type="file" id="upload" multiple style="display: none;" nv-file-select="" uploader="import.uploader">
          <span><strong id="chooseFile">Choose files</strong>â€‹ or drag them here.</span>
        </div>
      </div>

      <!-- Upload accordion settings-->
      <div class="checkbox" ng-show="import.uploader.queue.length">
        <div class="well">
          <label>
            <input type="checkbox" ng-model="oneAtATime">
            Open only one Upload at a time
          </label>
        </div>
      </div>
    </div>

    <div class="col-md-9">

      <h3>Upload queue</h3>
      <p>Queue length: {{ import.uploader.queue.length }}</p>

      <uib-accordion close-others="oneAtATime">
        <uib-accordion-group heading="{{upload.file.name}}" ng-init="isOpen = $index === 0" is-open="isOpen"
                             ng-repeat="upload in import.uploader.queue">

          <div class="col-md-6">
            <form>
              <div class="form-group">
                <label for="dataType">Data Type</label>
                <select id="dataType" class="form-control" ng-model="import.data[$index].dataType">
                  <option value="">Please select</option>
                  <option value="{{import.CONST_UPLOAD_TIMESERIES}}">time-series data</option>
                  <option value="{{import.CONST_UPLOAD_TABLEBASED}}">table data</option>
                  <option value="{{import.CONST_UPLOAD_GIS}}">GIS data</option>
                </select>
              </div>

              <div class="form-group">
                <div class="geo-picker" ng-model="import.geoPicker"
                     ng-hide="!import.data[$index].dataType || import.data[$index].dataType === import.CONST_UPLOAD_GIS">
                  <label>
                    Geo-Coords
                    <div class="input-group">
                      <input type="text" placeholder="LAT" class="form-control" ng-model="import.lat"
                             id="lat_{{import.hashFilename(upload.file.name)}}">
                      <span class="input-group-btn" style="width:0;"></span>
                      <input type="text" placeholder="LON" class="form-control" ng-model="import.lng"
                             id="lon_{{import.hashFilename(upload.file.name)}}">
                      <span class="input-group-btn" style="width:0;"></span>
                      <span class="input-group-btn">
                      <button class="btn btn-primary" ng-click="import.openGeoPicker($(this))">pick</button>
                        </span>
                    </div>
                  </label>
                </div>
              </div>

              <div class="form-group">
                <label for="privacy">Privacy</label>
                <select id="privacy" class="form-control" ng-model="import.data[$index].privacy" class="form-control">
                  <option value="">Please select</option>
                  <option value="PRIVATE">only for personal use</option>
                  <option value="PROJECT_PRIVATE">can only be used by project members</option>
                  <option value="PUBLIC">can be used by everyone</option>
                </select>
              </div>

              <div class="form-group">
                <label for="title">Title</label>
                <input type="text" id="title" class="form-control" ng-model="import.data[$index].title"
                       placeholder="Title of this data"
                       ng-trim="true">
              </div>

              <div class="form-group">
                <label>Description</label>
                <textarea class="form-control" rows="4" ng-model="import.data[$index].description"
                          placeholder="Description of this data"></textarea>
              </div>
            </form>
          </div>

          <div class="col-md-6">
            <div class="form-group" ng-show="import.uploader.isHTML5">
              <label class="control-label">File size:</label>
              {{ upload.file.size/1024/1024|number:2 }} MB
            </div>

            <div ng-show="import.uploader.isHTML5">
              <div class="form-group" ng-hide="upload.isSuccess || upload.isCancel || upload.isError">
                <div class="progress-bar" role="progressbar"></div>
              </div>
              <div class="alert alert-success" ng-show="upload.isSuccess"><i class="glyphicon glyphicon-ok"></i>
                ok
              </div>
              <div class="alert alert-warning" ng-show="upload.isProcessing"><i
                class="glyphicon glyphicon-refresh"></i>
                processing
              </div>
              <div class="alert alert-warning" ng-show="upload.isCancel"><i
                class="glyphicon glyphicon-ban-circle"></i>
                canceled
              </div>
              <div class="alert alert-danger" ng-show="upload.isError"><i class="glyphicon glyphicon-remove"></i>
                failed
              </div>
            </div>
            <button type="button" class="btn btn-warning btn-xs" ng-click="upload.cancel()"
                    ng-disabled="!upload.isUploading">
              <span class="glyphicon glyphicon-ban-circle"></span> Cancel
            </button>
            <button type="button" class="btn btn-danger btn-xs" ng-click="upload.remove()">
              <span class="glyphicon glyphicon-trash"></span> Remove
            </button>
          </div>
        </uib-accordion-group>
      </uib-accordion>

      <div ng-show="import.uploader.queue.length">
        <button type="button" class="btn btn-success btn-s" ng-click="import.uploadFiles()"
                ng-disabled="!import.uploader.getNotUploadedItems().length">
          <span class="glyphicon glyphicon-upload"></span> Upload
        </button>
        <button type="button" class="btn btn-warning btn-s" ng-click="import.uploader.cancelAll()"
                ng-disabled="!import.uploader.isUploading">
          <span class="glyphicon glyphicon-ban-circle"></span> Cancel
        </button>
        <button type="button" class="btn btn-danger btn-s" ng-click="import.uploader.clearQueue()"
                ng-disabled="!import.uploader.queue.length">
          <span class="glyphicon glyphicon-trash"></span> Remove all
        </button>
      </div>

    </div>
  </div>
</div>

<!--&lt;!&ndash; geo-picker container &ndash;&gt;-->
<!--<div id="map-borders">-->
<!--<div id="map"></div>-->
<!--<label>LAT:-->
<!--<span id="cur-lat"></span>-->
<!--</label>-->
<!--<label>LON:-->
<!--<span id="cur-lon"></span>-->
<!--</label>-->
<!--<button class="btn btn-primary" onclick="import.closeGeoPicker()">done</button>-->
<!--</div>-->
